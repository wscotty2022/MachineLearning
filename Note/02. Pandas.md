# 数据分析 - Pandas

## 简介

1. Pandas是基于NumPy构建的，让以NumPy为中心的应用变得更加简单。
2. Pandas是使数据分析工作变得更快、更简单的高级数据结构和操作工具。
3. 提供数据**按轴自动对齐**或数据对齐显示功能，可以防止许多由于数据未对齐以及数据源不同（索引方式不同）而导致的常见错误。
4. 处理缺失数据

> 两个主要数据结构：**Series**和**DataFrame**。

### Series数据结构

Series是一种类似于**一维数组**的对象，由**一组数据**以及一组与之相关的**数据标签（索引）**组成。

Series由两部分构成：索引放在左边，值放在右边。

如果没有为数据指定索引，Series也会自动创建一个0到N-1的整数型索引。

- Pandas最简单的Series
```python
from pandas import Series
obj = Series(["287xxxx42","391xxxx91","281xxxx12","371xxxx31","261xxxx42"])
print(obj)

# Output:
# 0    287xxxx42
# 1    391xxxx91
# 2    281xxxx12
# 3    371xxxx31
# 4    261xxxx42
# dtype: object
```

- Pandas的Series的索引和值
```python
from pandas import Series
obj = Series(["287xxxx42","391xxxx91","281xxxx12","371xxxx31","261xxxx42"])
obj_index = obj.index
obj_values = obj.values
print(obj_index)
print(obj_values)

# Output:
# RangeIndex(start=0, stop=5, step=1)
# ['287xxxx42' '391xxxx91' '281xxxx12' '371xxxx31' '261xxxx42']

# Explaination:
# obj.index内存储的就是Series中的索引
# obj.values内存储的就是Series的值。
```

- Pandas的Series的索引和值的输出
```python
from pandas import Series
obj = Series(["287xxxx42","391xxxx91","281xxxx12","371xxxx31","261xxxx42"], index =["qq_name1","qq_name2","qq_name3","qq_name4","qq_name5"])
print(obj)

# Output:
# qq_name1    287xxxx42
# qq_name2    391xxxx91
# qq_name3    281xxxx12
# qq_name4    371xxxx31
# qq_name5    261xxxx42
# dtype: object
```

- Pandas中根据Series的索引输出值
```python
from pandas import Series
obj = Series(["287xxxx42","391xxxx91","281xxxx12","371xxxx31","261xxxx42"], index =["qq_name1","qq_name2","qq_name3","qq_name4","qq_name5"])
print(obj)

# Output:
# qq_name1    287xxxx42
# qq_name2    391xxxx91
# qq_name3    281xxxx12
# qq_name4    371xxxx31
# qq_name5    261xxxx42
# dtype: object
```

```python
from pandas import Series
obj=Series(["287xxxx42","391xxxx91","281xxxx12","371xxxx31","261xxxx42"], index=["qq_name1","qq_name2","qq_name3","qq_name4","qq_name5"])
print(obj["qq_name1"])

# Output:
# 287xxxx42

# Explanation:
# 通过obj["qq_name1"]的引用方式来访问Series中"qq_name1"对应的值。
```

- Pandas中根据字典创建Series
```python
from pandas import Series
dicts = {"qq_name1":287xxxx42,"qq_name2":391xxxx91,"qq_name3":281xxxx12,"qq_name4":371xxxx31,"qq_name5":261xxxx42}
obj = Series(dicts)
print(obj)

# Output:
# qq_name1    287xxxx42
# qq_name2    391xxxx91
# qq_name3    281xxxx12
# qq_name4    371xxxx31
# qq_name5    261xxxx42
# dtype: object
```

### Series数据类型的运算

Series这种数据类型的最重要的一个功能是在进行算术运算时会**自动对齐**不同索引的数据。

- Pandas中根据Series数据类型的相加运算
```python
from pandas import Series
goods_in = Series({"苹果":30,"梨":25,"香蕉":20,"桃":21,"李子":15})
goods_other_in = Series({"苹果":10,"梨":20,"香蕉":15,"桃":10,"西瓜":50})
goods_kucun = goods_in + goods_other_in
print(goods_kucun)

# Output:
# 李子     NaN
# 桃     31.0
# 梨     45.0
# 苹果    40.0
# 西瓜     NaN
# 香蕉    35.0
# dtype: float64
```

> 如果两个Series相加，索引在两个Series中存在的话，就实现索引对应值的计算；如果其中一个Series中有的索引，另一个Series中没有，相加的结果中就会出现**NaN**（表示空值）这样的值。

- Pandas中根据Series索引赋值修改内容
```python
from pandas import Series
import numpy as np
goods = Series([30,25,20,21,np.nan],index=["苹果","梨","香蕉","桃","李子"])
goods["李子"] = 15
print(goods)

# Output:
# 苹果    30.0
# 梨     25.0
# 香蕉    20.0
# 桃     21.0
# 李子    15.0
# dtype: float64
```

### DataFrame数据结构

DataFrame是一个**表格型**的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型等）。

DataFrame既有**行索引**也有**列索引**，它可以被看作由Series组成的字典，只不过共用了索引。

- Pandas模块构建DataFrame
```python
from pandas import DataFrame
paints = {"字画名称":["旭日东升","富水长流","招财进宝","鸿运当头"],"字画底价":[2860,498,1068,598],"字画拍卖加价":[1000,2000,500,1500]}
goods_in = DataFrame(paints)
print(goods_in)

# Output:
#    字画名称  字画底价  字画拍卖加价
# 0  旭日东升  2860    1000
# 1  富水长流   498    2000
# 2  招财进宝  1068     500
# 3  鸿运当头   598    1500
```

- 利用Pandas模块的DataFrame指定列顺序
```python
from pandas import DataFrame
paints = {"字画名称":["旭日东升","富水长流","招财进宝","鸿运当头"],"字画底价":[2860,498,1068,598],"字画拍卖加价":[1000,2000,500,1500]}
goods_in = DataFrame(paints, columns = ["字画名称","字画拍卖加价","字画底价"])
print(goods_in)

# Output:
#    字画名称  字画拍卖加价  字画底价
# 0  旭日东升    1000  2860
# 1  富水长流    2000   498
# 2  招财进宝     500  1068
# 3  鸿运当头    1500   598
```

DataFrame最终是按照columns指定的顺序排列的。如果传入的列名在数据中是无法找到的，就会产生NaN值。

- 利用Pandas模块的DataFrame指定列空缺
```python
from pandas import DataFrame
paints = {"字画名称":["旭日东升","富水长流","招财进宝","鸿运当头"],"字画底价":[2860,498,1068,598],"字画拍卖加价":[1000,2000,500,1500]}
goods_in = DataFrame(paints, columns = ["字画名称","字画拍卖加价","字画底价","字画所属人"])
print(goods_in)

# Output:
#    字画名称  字画拍卖加价  字画底价 字画所属人
# 0  旭日东升    1000  2860   NaN
# 1  富水长流    2000   498   NaN
# 2  招财进宝     500  1068   NaN
# 3  鸿运当头    1500   598   NaN
```

- 利用Pandas模块的DataFrame通过字典标记的方式获取Series结构列数据
```python
from pandas import DataFrame
paints = {"字画名称":["旭日东升","富水长流","招财进宝","鸿运当头"],"字画底价":[2860,498,1068,598],"字画拍卖加价":[1000,2000,500,1500]}
goods_in = DataFrame(paints, index = ["第一幅","第二幅","第三幅","第四幅"])
paints_price = goods_in["字画底价"]
print(paints_price)

# Output:
# 第一幅    2860
# 第二幅     498
# 第三幅    1068
# 第四幅     598
# Name: 字画底价, dtype: int64

# Explanation:
# 代码中定义了字画的DataFrame之后，直接通过goods_in["字画底价"]来访问“字画底价”这个维度的数据，获取的是一个Series结构的数据。
```

